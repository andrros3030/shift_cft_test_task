# Тестовое задание для проекта ШИФТ компании ЦФТ
Выполнил Рощупкин Андрей Владимирович от 19.12.2021 (подготовлено к 27.12.2021) в рамках отбора на курсы
# Задания:

~~1.  Подготовьте DDL-скрипты создания объектов для приведённой модели: создание таблиц,
первичных, уникальных, внешних ключей и т.д.~~

~~2.  Заполните таблицы примерами из приложенного скрипта.~~

~~3.	Подготовьте скрипты заполнения таблиц тестовыми данными, достаточными для выполнения заданий ниже.~~

~~4.	Сформируйте отчет, который содержит все счета, относящиеся к продуктам типа ДЕПОЗИТ, принадлежащих клиентам, у которых нет открытых продуктов типа КРЕДИТ.~~

5.	Сформируйте выборку, который содержит средние движения по счетам в рамках одного произвольного дня, в разрезе типа продукта.

6.	Сформируйте выборку, в который попадут клиенты, у которых были операции по счетам за прошедший месяц от текущей даты. Выведите клиента и сумму операций за день в разрезе даты.

7.	В результате сбоя в базе данных разъехалась информация между остатками и операциями по счетам. Напишите нормализацию (процедуру выравнивающую данные), которая найдет такие счета и восстановит остатки по счету.

8.	Сформируйте выборку, который содержит информацию о клиентах, которые полностью погасили кредит, но при этом не закрыли продукт и пользуются им дальше (по продукту есть операция новой выдачи кредита).

9.	Закройте продукты (установите дату закрытия равную текущей) типа КРЕДИТ, у которых произошло полное погашение, но при этом не было повторной выдачи.

10.	Закройте возможность открытия (установите дату окончания действия) для типов продуктов, по счетам продуктов которых, не было движений более одного месяца.

11.	В модель данных добавьте сумму договора по продукту. Заполните поле для всех продуктов суммой максимальной дебетовой операции по счету для продукта типа КРЕДИТ, и суммой максимальной кредитовой операции по счету продукта для продукта типа ДЕПОЗИТ или КАРТА.
